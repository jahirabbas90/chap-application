{"version":3,"sources":["webpack:///src/app/page/en-new-individual-chat/en-new-individual-chat.page.ts","webpack:///src/app/page/en-new-individual-chat/en-new-individual-chat.page.html","webpack:///src/app/page/en-new-individual-chat/en-new-individual-chat.module.ts","webpack:///src/app/page/en-new-individual-chat/en-new-individual-chat.page.scss","webpack:///src/app/page/en-new-individual-chat/en-new-individual-chat-routing.module.ts"],"names":["EnNewIndividualChatPage","router","_connecter","checkedUser","_allUsr","_visibleUsr","authUser$","subscribe","data","_authUsr","Object","keys","length","navigate","getUsers","allUser$","data1","evt","searchTerm","srcElement","value","filter","item","name","toLowerCase","indexOf","removeAuth","fetchUsers","email","usr","console","log","JSON","stringify","personal_chats","indx","findIndex","uid","id","fcm_token","localStorage","setItem","ar","message_count","title","group","visible_name","unread","last_message","cAr1","cAr2","warn","createNewChat","selector","template","EnNewIndividualChatPageModule","imports","declarations","routes","path","component","EnNewIndividualChatPageRoutingModule","forChild","exports"],"mappings":"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","file":"page-en-new-individual-chat-en-new-individual-chat-module-es5.js","sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\n\nimport { MyConnecterService } from '../../services/my-connecter.service';\n\n@Component({\n  selector: 'app-en-new-individual-chat',\n  templateUrl: './en-new-individual-chat.page.html',\n  styleUrls: ['./en-new-individual-chat.page.scss'],\n})\nexport class EnNewIndividualChatPage implements OnInit {\n  [x: string]: any;\n  checkedUser = [];\n  public userListBackup: any[];\n  public userList: any[];\n  chatListBackup: any[];\n  allChats: any;\n  userId:any;\n  chats:any;\n  \n  \n  _authUsr: any;\n  _allUsr= [];\n  _visibleUsr= [];\n\n  constructor(\n    private router: Router,\n    private _connecter: MyConnecterService\n    ) {\n      _connecter.authUser$.subscribe(data => {\n        this._authUsr = data;\n        //console.log(this._authUsr)\n        if(Object.keys(this._authUsr).length === 0) {\n          this.router.navigate(['/en-login']);\n        }\n        else{\n          this.getUsers();\n        }\n      });\n      \n      _connecter.allUser$.subscribe(data1 => {\n        this._allUsr = data1;\n        this._visibleUsr = this._allUsr;       \n      });\n  }\n\n  ngOnInit() {\n  }\n\n\n  viewNewGroup() {\n    this.router.navigate(['/en-create-room']);\n  }\n\n  async filterList(evt) {\n    const searchTerm = evt.srcElement.value;\n\n    if (!searchTerm) {\n      this._visibleUsr = this._allUsr;\n      return;\n    }\n\n    this._visibleUsr = this._allUsr.filter(item => {      \n      return item.name.toLowerCase().indexOf(searchTerm.toLowerCase()) > -1\n    });\n\n  }\n\n  \n\n  signOut() {\n    this._connecter.removeAuth();\n  }\n\n  getUsers() {\n    this._connecter.fetchUsers(this._authUsr.email);\n  }\n\n  startNewChat(usr) {\n    // routerLink='/single-user-chat/{{u.name}}'\n    console.log(JSON.stringify(usr))\n    if (this._authUsr.personal_chats) {\n      let indx = usr.personal_chats.findIndex(item=>item.uid == this._authUsr.id);\n    // console.log(indx);\n    if(indx > -1) {\n      console.log(JSON.stringify( usr.fcm_token))\n      localStorage.setItem(\"ousr_fcm_token\",\"\"+usr.fcm_token);\n      // alert(1)\n      this.router.navigate(['/single-user-chat', usr.personal_chats[indx]['chat_id']]);\n    }\n    else {\n      console.log(JSON.stringify( usr))\n\n      var ar = {\n        message_count: 0,\n        title: null,\n        group: false,\n        visible_name: [\n          {\n            uid: this._authUsr.id,\n            name: usr.name,\n            unread: 0,\n            fcm_token:usr.fcm_token\n          },\n          {\n            uid: usr.id,\n            name: this._authUsr.name,\n            unread: 0,\n            fcm_token:this._authUsr.fcm_token\n          }\n        ],\n        last_message: null\n      };\n      var cAr1 = this._authUsr.personal_chats;\n      var cAr2 = usr.personal_chats;\n      // localStorage.setItem(\"other_fcm_token\",\"\"+usr.fcm_token);\n      console.warn(\"OtherUser : \"+JSON.stringify(usr.fcm_token));\n      localStorage.setItem(\"ousr_fcm_token\",\"\"+usr.fcm_token);\n      console.warn(\"OwnUser : \"+JSON.stringify(this._authUsr.fcm_token));\n      console.warn(\"ar  : \"+JSON.stringify(ar));\n      this._connecter.createNewChat(ar, this._authUsr.id, cAr1, usr.id, cAr2);\n    }\n    }\n    \n  }\n\n}\n","export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\" routerLink=\\\"/en-all-rooms\\\">\\n      <ion-icon name=\\\"arrow-back-outline\\\"></ion-icon>\\n    </ion-buttons>\\n    <ion-title>New Chat</ion-title>\\n  </ion-toolbar>\\n  <ion-toolbar>\\n    <ion-searchbar showcancelbutton=\\\"\\\"\\n    (ionInput)=\\\"filterList($event)\\\"></ion-searchbar>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n\\n\\n  <ion-list>\\n    <ion-item button (click)=\\\"viewNewGroup()\\\">\\n      <ion-icon slot=\\\"start\\\" name=\\\"people\\\"></ion-icon>\\n      <ion-label>New Group</ion-label>\\n    </ion-item>\\n    <!-- <ion-item button *ngFor=\\\"let u of checkedUser; let c_i = index\\\"  (click)=\\\"findId(u.id)\\\" [routerLink]=\\\"['/', 'single-user-chat',u.nickname,u.id]\\\">\\n      <ion-avatar slot=\\\"start\\\">\\n        <img src=\\\"https://via.placeholder.com/200x200\\\">\\n      </ion-avatar>\\n      <ion-label >\\n        <h3>{{u.nickname}}</h3>\\n        <p>Test Message</p>\\n      </ion-label>\\n    </ion-item> -->\\n    <ion-item button *ngFor=\\\"let u of _visibleUsr\\\" (click)=\\\"startNewChat(u)\\\"  >\\n      <ion-avatar slot=\\\"start\\\">\\n        <img src=\\\"assets/avatar.svg\\\">\\n      </ion-avatar>\\n      <ion-label >\\n        <h3>{{u.name}}</h3>\\n        <!-- <p>Test Message</p> -->\\n      </ion-label>\\n    </ion-item>\\n  </ion-list>\\n</ion-content>\";","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { EnNewIndividualChatPageRoutingModule } from './en-new-individual-chat-routing.module';\n\nimport { EnNewIndividualChatPage } from './en-new-individual-chat.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    EnNewIndividualChatPageRoutingModule\n  ],\n  declarations: [EnNewIndividualChatPage]\n})\nexport class EnNewIndividualChatPageModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJlbi1uZXctaW5kaXZpZHVhbC1jaGF0LnBhZ2Uuc2NzcyJ9 */\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { EnNewIndividualChatPage } from './en-new-individual-chat.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: EnNewIndividualChatPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class EnNewIndividualChatPageRoutingModule {}\n"]}